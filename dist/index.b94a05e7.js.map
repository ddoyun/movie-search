{"mappings":"AAAOA,eAAeC,EAAUC,EAAOC,EAAMC,GAC3C,MAAMC,QAAYC,MAAM,0CAA0CJ,OAAWC,UAAaC,MAClFG,OAAQC,EAAQC,aAAcC,SAAgBL,EAAIM,OAC1D,MAAO,C,OAAEH,E,MAAQE,EACnB,CCFO,SAASE,EAAaJ,EAAQJ,EAAMS,GAEzC,MAAMC,EAAcC,OAAOP,EAAOE,OAOlC,GAJAM,EAAQC,UAAUC,IAAI,QACtBC,EAAUF,UAAUG,OAAO,QAGvBC,EAASC,kBAAoBd,EAAOA,OAKtC,OAJiB,EACjBQ,EAAQC,UAAUG,OAAO,QACzBD,EAAUF,UAAUG,OAAO,QAC3BG,QAAQC,IAAI,YACL,EACF,IAAKhB,EAAOA,OAKjB,OAJiB,EACjBQ,EAAQC,UAAUG,OAAO,QACzBD,EAAUF,UAAUG,OAAO,QAC3BK,MAAM,kBACC,EAGT,IAAK,MAAMC,KAASlB,EAAOA,OAAQ,CACjC,MAAMmB,EAAKC,SAASC,cAAc,OAC5BC,EAAOF,SAASC,cAAc,MAC9BE,EAAQH,SAASC,cAAc,OAGrCF,EAAGV,UAAUC,IAAI,SACjBS,EAAGK,OAAOF,EAAMC,GAGhBD,EAAKG,YAAcP,EAAMQ,MACzBJ,EAAKK,iBAAiB,SAAS,KAC7BZ,QAAQC,IAAIE,EAAMQ,MAAK,IAIzBH,EAAMK,IAAMV,EAAMW,OAClBd,QAAQC,IAAIO,EAAMK,KACA,QAAdL,EAAMK,MACRb,QAAQC,IAAIO,EAAMK,KAClBL,EAAMK,IAAM,iBAYdf,EAASW,OAAOL,EAClB,CAEAX,EAAQC,UAAUG,OAAO,QAGrBN,EAAe,IAAOV,EACxBe,EAAUF,UAAUG,OAAO,QAE3BD,EAAUF,UAAUC,IAAI,OAE5B,CC1DO,MAAMF,EAAUY,SAASU,cAAc,YACjCjB,EAAWO,SAASU,cAAc,WAClCnB,EAAYS,SAASU,cAAc,SAC1CC,EAAcX,SAASU,cAAc,eACrCE,EAAaZ,SAASU,cAAc,iBACpCG,EAAYb,SAASU,cAAc,iBACnCI,GAAa,IAAIC,MAAOC,cAE9B,IAAIC,EAAQ,GACRC,EAAO,EACPC,GAAiB,EAGrB,IAAK,IAAIC,EAAIN,EAAYM,EAAIN,EAAa,GAAIM,IAAK,CACjD,MAAMC,EAASrB,SAASC,cAAc,UACtCoB,EAAOC,MAAQF,EACfC,EAAOhB,YAAce,EACrBR,EAAWR,OAAOiB,EACpB,CA2CAjD,eAAemD,IACb,IAAIhD,EAAOqC,EAAWU,MACtBJ,GAAQ,EAGR,MAAMM,QAAkBnD,EAAU4C,EAAO1C,EAAM2C,GAG7B/B,OAAOqC,EAAU1C,OAChB,IAAOoC,IACxBC,GAAiB,GAInBnC,EAAawC,EAAWN,EAC1B,CArDAlB,SAASU,cAAc,SAASH,iBAAiB,SAAUkB,IACzDR,EAAQQ,EAAEC,OAAOJ,KAAK,IAExBX,EAAYJ,iBAAiB,SAASnC,UAIpC,GAFA+C,GAAiB,EAEH,KAAVF,EACFpB,MAAM,eACNJ,EAASkC,UAAY,OAChB,CACL,IAAIpD,EAAOqC,EAAWU,MACtBJ,EAAO,EAGP,MAAMM,QAAkBnD,EAAU4C,EAAO1C,EAAM2C,GAC/CzB,EAASkC,UAAY,GAGrB3C,EAAawC,EAAWN,GAGxB,IAAIU,EAAWf,EAAUS,MACzB,IAAK,IAAIF,EAAI,EAAGA,EAAIQ,EAAUR,IAC5BG,GAEJ,KAIFhC,EAAUgB,iBAAiB,SAASnC,UAClC,IAAIwD,EAAWf,EAAUS,MACzB,IAAK,IAAIF,EAAI,EAAGA,GAAKQ,EAAUR,IAC7BG,GAAA,IAwBJ,MAAMM,EAAK,IAAIC,sBAAqB,CAACC,EAAOC,KAE1C,MAAMC,EAAWF,EAAM,GAAGL,OAG1B,GADA/B,QAAQC,IAAIuB,GACRY,EAAM,GAAGG,gBAAkBf,EAAgB,CAC7CxB,QAAQC,IAAI,YAAaqC,GAKzB,IAAIL,EAAWf,EAAUS,MACzB,IAAK,IAAIF,EAAI,EAAGA,GAAKQ,EAAUR,IAC7BG,IAIFM,EAAGM,QAAQ5C,EACb,IACC,CAED6C,UAAW,IAGbP,EAAGM,QAAQ5C","sources":["js/getMovies.js","js/renderMovies.js","js/main.js"],"sourcesContent":["export async function getMovies(title, year, page) {\r\n  const res = await fetch(`https://omdbapi.com/?apikey=7035c60c&s=${title}&y=${year}&page=${page}`);\r\n  const { Search: movies, totalResults: total } = await res.json();\r\n  return { movies, total };\r\n}","import { moviesEl, loading, moreBtnEl } from './main.js';\r\n\r\nexport function renderMovies(movies, page, infiniteScroll) {\r\n  // 총 영화 개수\r\n  const totalMovies = Number(movies.total);\r\n\r\n  // 로딩\r\n  loading.classList.add('show');\r\n  moreBtnEl.classList.remove('show');\r\n\r\n  // 검색된 영화 없을 때\r\n  if (moviesEl.hasChildNodes() && !movies.movies) {\r\n    infiniteScroll = false;\r\n    loading.classList.remove('show');\r\n    moreBtnEl.classList.remove('show');\r\n    console.log('마지막 페이지');\r\n    return false;\r\n  } else if (!movies.movies) {\r\n    infiniteScroll = false;\r\n    loading.classList.remove('show');\r\n    moreBtnEl.classList.remove('show');\r\n    alert('검색된 영화가 없습니다.');\r\n    return false;\r\n  }\r\n\r\n  for (const movie of movies.movies) {\r\n    const el = document.createElement('div');\r\n    const h1El = document.createElement('h1');\r\n    const imgEl = document.createElement('img');\r\n\r\n    // 영화 정보 뿌리기\r\n    el.classList.add('movie');\r\n    el.append(h1El, imgEl);\r\n\r\n    // 영화 타이틀\r\n    h1El.textContent = movie.Title;\r\n    h1El.addEventListener('click', () => {\r\n      console.log(movie.Title)\r\n    });\r\n\r\n    // 영화 포스터\r\n    imgEl.src = movie.Poster;\r\n    console.log(imgEl.src);\r\n    if (imgEl.src === 'N/A') {\r\n      console.log(imgEl.src);\r\n      imgEl.src = './noImage.png';\r\n    }\r\n\r\n    // el.innerHTML = /* html */ `\r\n    //   <h1>${movie.Title}</h1>\r\n    //   <img src=\"${movie.Poster}\" />\r\n    // `;\r\n    // const h1El = el.querySelector('h1');\r\n    // h1El.addEventListener('click', () => {\r\n    //   console.log(movie.Title)\r\n    // })\r\n\r\n    moviesEl.append(el);\r\n  }\r\n  // 로딩\r\n  loading.classList.remove('show');\r\n\r\n  // 마지막 페이지\r\n  if ((totalMovies / 10) <= page) {\r\n    moreBtnEl.classList.remove('show');\r\n  } else {\r\n    moreBtnEl.classList.add('show');\r\n  }\r\n}","import { getMovies } from './getMovies.js';\r\nimport { renderMovies } from './renderMovies.js';\r\n\r\n// API\r\n// fetch('https://omdbapi.com/?apikey=7035c60c&s=frozen')\r\n//   .then(res => res.json())\r\n//   .then(res => console.log(res))\r\n// await 사용시, 감싸는 함수에 async 삽입 필요\r\n\r\n// 초기화 코드\r\nexport const loading = document.querySelector('.loading');\r\nexport const moviesEl = document.querySelector('.movies');\r\nexport const moreBtnEl = document.querySelector('.more');\r\nconst searchBtnEl = document.querySelector('.search-btn');\r\nconst selectYear = document.querySelector('.movies-years');\r\nconst selectCnt = document.querySelector('.movies-count');\r\nconst optionYear = new Date().getFullYear();\r\n\r\nlet title = '';\r\nlet page = 1;\r\nlet infiniteScroll = false;\r\n\r\n// 년도 옵션\r\nfor (let i = optionYear; i > optionYear - 38; i--) {\r\n  const yearEl = document.createElement('option');\r\n  yearEl.value = i;\r\n  yearEl.textContent = i;\r\n  selectYear.append(yearEl);\r\n}\r\n\r\n\r\n\r\n// 검색 기능\r\ndocument.querySelector('input').addEventListener('input', (e) => {\r\n  title = e.target.value;\r\n});\r\nsearchBtnEl.addEventListener('click', async () => {\r\n  // 무한 스크롤\r\n  infiniteScroll = true;\r\n\r\n  if (title === '') {\r\n    alert('제목을 입력해 주세요');\r\n    moviesEl.innerHTML = \"\";  // 검색 타이틀 초기화\r\n  } else {\r\n    let year = selectYear.value;\r\n    page = 1;  // 페이지 초기화\r\n\r\n    // 영화 가져오기\r\n    const getmovies = await getMovies(title, year, page);\r\n    moviesEl.innerHTML = \"\";  // 검색 타이틀 초기화\r\n\r\n    // 영화 리스트 랜더링\r\n    renderMovies(getmovies, page, infiniteScroll);\r\n\r\n    // 10,20,30 카운트 검색\r\n    let pageShow = selectCnt.value;\r\n    for (let i = 1; i < pageShow; i++) {\r\n      moreMovies();\r\n    }\r\n  }\r\n});\r\n\r\n// 더보기 버튼\r\nmoreBtnEl.addEventListener('click', async () => {\r\n  let pageShow = selectCnt.value;\r\n  for (let i = 1; i <= pageShow; i++) {\r\n    moreMovies();\r\n  }\r\n});\r\n\r\n// 더보기 페이지 증가\r\nasync function moreMovies() {\r\n  let year = selectYear.value;\r\n  page += 1;\r\n\r\n  // 영화 가져오기\r\n  const getmovies = await getMovies(title, year, page);\r\n\r\n  // 무한 스크롤\r\n  let totalMovies = Number(getmovies.total);\r\n  if ((totalMovies / 10) <= page) {\r\n    infiniteScroll = false;\r\n  }\r\n\r\n  // 영화 리스트 랜더링\r\n  renderMovies(getmovies, page, infiniteScroll);\r\n}\r\n\r\n// 무한 스크롤\r\n// 1. 인터섹션 옵저버 생성\r\nconst io = new IntersectionObserver((entry, observer) => {\r\n  // 3. 현재 보이는 target 출력\r\n  const ioTarget = entry[0].target;\r\n  // 4. viewport에 target이 보이면 하는 일\r\n  console.log(infiniteScroll);\r\n  if (entry[0].isIntersecting && infiniteScroll) {\r\n    console.log('현재 보이는 타켓', ioTarget);\r\n    // 5. 현재 보이는 target 감시 취소\r\n    // io.unobserve(endEl);\r\n\r\n    // 6. 더보기 페이지 증가\r\n    let pageShow = selectCnt.value;\r\n    for (let i = 1; i <= pageShow; i++) {\r\n      moreMovies();\r\n    }\r\n\r\n    // 7. 새로 추가된 target 감시\r\n    io.observe(moreBtnEl);\r\n  }\r\n}, {\r\n  // 5. 타겟이 100% 보이면 실행\r\n  threshold: 1\r\n});\r\n// 2. 타켓 감시\r\nio.observe(moreBtnEl);"],"names":["async","$4149f49e4262c4f0$export$60e1c8f5f122c5ac","title","year","page","res","fetch","Search","movies","totalResults","total","json","$5e6e2fe5b51abc71$export$1a30573fde3dfc62","infiniteScroll","totalMovies","Number","$77ac944da51b7354$export$46c1c92549715335","classList","add","$77ac944da51b7354$export$d44e8720f1d377b","remove","$77ac944da51b7354$export$d5e1f30add85e8c4","hasChildNodes","console","log","alert","movie","el","document","createElement","h1El","imgEl","append","textContent","Title","addEventListener","src","Poster","querySelector","$77ac944da51b7354$var$searchBtnEl","$77ac944da51b7354$var$selectYear","$77ac944da51b7354$var$selectCnt","$77ac944da51b7354$var$optionYear","Date","getFullYear","$77ac944da51b7354$var$title","$77ac944da51b7354$var$page","$77ac944da51b7354$var$infiniteScroll","i","yearEl","value","$77ac944da51b7354$var$moreMovies","getmovies","e","target","innerHTML","pageShow","$77ac944da51b7354$var$io","IntersectionObserver","entry","observer","ioTarget","isIntersecting","observe","threshold"],"version":3,"file":"index.b94a05e7.js.map"}